<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Солнечная микрогенерация — комплекты и подключение | АО «Россети Кубань»</title>

<!-- Шрифты -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">

<!-- EmailJS SDK -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script type="text/javascript">
  // ИНСТРУКЦИЯ ПО НАСТРОЙКЕ АВТОМАТИЧЕСКОЙ ОТПРАВКИ EMAIL:
  
  // ВАРИАНТ 1: EmailJS (рекомендуется, бесплатно до 200 писем/месяц)
  // 1. Зарегистрируйтесь на https://www.emailjs.com/
  // 2. Создайте Email Service (Gmail, Outlook или другой)
  // 3. Создайте Email Template со следующими переменными:
  //    {{to_email}}, {{from_name}}, {{from_email}}, {{phone}}, 
  //    {{address}}, {{pack_type}}, {{comment}}, {{date}}
  // 4. Скопируйте ваш Public Key, Service ID и Template ID
  // 5. Вставьте их в код ниже
  
  // ВАРИАНТ 2: Google Apps Script (полностью бесплатно)
  // Код для Google Apps Script приведен в конце этого файла
  
  (function(){
    // Замените на ваш Public Key из EmailJS
    emailjs.init("YOUR_PUBLIC_KEY");
  })();
</script>

<style>
  /* ===== Брендовые токены (Россети) ===== */
  :root{
    /* Официальные цвета Россети */
    --rs-blue:#004B87;         /* Основной синий Россети */
    --rs-blue-dark:#003366;    /* Темный синий */
    --rs-blue-light:#0066CC;   /* Светлый синий */
    --rs-accent:#0084FF;       /* Акцентный синий */
    --rs-green:#4CAF50;        /* Зеленый (энергия) */
    
    /* UI цвета */
    --ink:#333333;
    --muted:#666666;
    --bg:#FFFFFF;
    --bg-gray:#F5F5F5;
    --card:#FFFFFF;
    --border:#E0E0E0;
    --ok:#4CAF50;
    --warn:#FF9800;
    --bad:#F44336;

    /* Геометрия и тени */
    --radius:4px;
    --radius-sm:2px;
    --radius-lg:8px;
    --shadow:0 2px 4px rgba(0,0,0,.1);
    --shadow-hover:0 4px 8px rgba(0,0,0,.15);
    --maxw:1140px;
    
    /* Анимации */
    --ease-out:cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --ease-in-out:cubic-bezier(0.42, 0, 0.58, 1);
  }

  *{box-sizing:border-box}
  html,body{margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;
    color:var(--ink);
    background:var(--bg);
    -webkit-font-smoothing:antialiased; 
    -moz-osx-font-smoothing:grayscale;
    overflow-x:hidden;
    line-height:1.5;
  }
  a{color:var(--rs-blue);text-decoration:none;transition:color .2s}
  a:hover{color:var(--rs-blue-light);text-decoration:underline}
  img{max-width:100%;display:block}

  /* ===== Прогресс-индикатор ===== */
  .scrollbar{
    position:fixed; top:0; left:0; height:3px; width:0%;
    background:var(--rs-blue);
    z-index:1100;
    transition:width .1s var(--ease-out);
  }

  /* ===== Хедер с корпоративным стилем ===== */
  header{
    position:sticky; top:0; z-index:1000;
    background:#FFFFFF;
    border-bottom:1px solid var(--border);
    box-shadow:0 1px 3px rgba(0,0,0,.1);
  }
  .nav{
    max-width:var(--maxw); margin:auto; padding:0 15px;
    display:flex; align-items:center; justify-content:space-between;
    height:70px;
  }
  .logo{
    display:flex; align-items:center; gap:12px; 
    font-weight:700; color:var(--rs-blue);
  }
  .logo-img{
    height:40px; width:auto;
  }
  .logo-text{
    display:flex; flex-direction:column; line-height:1.2;
  }
  .logo-text .company{font-size:18px;}
  .logo-text .dept{font-size:14px; color:var(--muted); font-weight:400;}
  
  .navlinks{display:flex; gap:30px; align-items:center;}
  .nav a{font-weight:400; color:var(--ink); position:relative; font-size:15px;}
  .navlinks a:hover{text-decoration:none; color:var(--rs-blue);}
  .navlinks a::after{
    content:''; position:absolute; bottom:-25px; left:0; right:0; height:3px;
    background:var(--rs-blue); transform:scaleX(0); transition:.2s transform;
  }
  .navlinks a:hover::after{transform:scaleX(1);}
  
  /* Кнопки в корпоративном стиле */
  .btn{
    padding:10px 24px; border-radius:var(--radius); border:none;
    font-weight:500; font-size:15px; cursor:pointer;
    transition:all .2s; display:inline-block; text-align:center;
    text-decoration:none;
  }
  .btn-primary{
    background:var(--rs-blue); color:#fff;
  }
  .btn-primary:hover{
    background:var(--rs-blue-dark); 
    text-decoration:none; color:#fff;
  }
  .btn-secondary{
    background:#fff; color:var(--rs-blue); 
    border:1px solid var(--rs-blue);
  }
  .btn-secondary:hover{
    background:var(--rs-blue); color:#fff;
    text-decoration:none;
  }

  /* ===== Мобильное меню ===== */
  .menu-toggle{
    display:none; width:40px; height:40px; 
    background:transparent; border:1px solid var(--border); 
    cursor:pointer; position:relative;
  }
  .menu-toggle span{
    display:block; width:20px; height:2px; background:var(--rs-blue);
    position:absolute; left:50%; transform:translateX(-50%);
    transition:.2s;
  }
  .menu-toggle span:nth-child(1){top:11px}
  .menu-toggle span:nth-child(2){top:19px}
  .menu-toggle span:nth-child(3){bottom:11px}
  .menu-toggle.active span:nth-child(1){transform:translateX(-50%) rotate(45deg); top:19px}
  .menu-toggle.active span:nth-child(2){opacity:0}
  .menu-toggle.active span:nth-child(3){transform:translateX(-50%) rotate(-45deg); bottom:19px}

  /* ===== Hero корпоративный ===== */
  .hero{
    background:var(--bg-gray);
    border-bottom:1px solid var(--border);
  }
  .hero .wrap{
    max-width:var(--maxw); margin:auto; padding:60px 15px; 
  }
  
  .breadcrumb{
    font-size:14px; color:var(--muted); margin-bottom:30px;
  }
  .breadcrumb a{color:var(--muted)}
  .breadcrumb a:hover{color:var(--rs-blue)}
  
  h1{
    font-size:36px; font-weight:700; line-height:1.2;
    margin:0 0 20px; color:var(--rs-blue);
  }
  
  .lead{
    font-size:18px; color:var(--ink); 
    max-width:800px; line-height:1.6; margin-bottom:30px;
  }
  
  .hero-stats{
    display:grid; grid-template-columns:repeat(3,1fr); gap:20px; 
    margin-top:40px; max-width:800px;
  }
  .stat-card{
    background:#fff; border:1px solid var(--border); 
    padding:20px; text-align:center;
  }
  .stat-card .number{
    font-size:32px; font-weight:700; color:var(--rs-blue); 
    margin-bottom:5px;
  }
  .stat-card .label{
    font-size:14px; color:var(--muted);
    text-transform:uppercase; letter-spacing:0.5px;
  }

  /* ===== Секции ===== */
  section{
    max-width:var(--maxw); margin:0 auto; padding:60px 15px;
  }
  h2{
    font-size:28px; font-weight:700; color:var(--ink); 
    margin:0 0 30px; text-align:center;
  }
  .section-desc{
    color:var(--muted); margin:-20px auto 40px; 
    font-size:16px; text-align:center; max-width:700px;
  }
  
  .grid{display:grid; gap:20px}
  .grid.cols-3{grid-template-columns:repeat(3,1fr)}
  .grid.cols-2{grid-template-columns:repeat(2,1fr)}
  
  .card{
    background:#fff; border:1px solid var(--border); 
    padding:30px; transition:all .2s;
  }
  .card:hover{
    box-shadow:var(--shadow-hover);
  }

  /* ===== Преимущества корпоративные ===== */
  .benefit{padding:0;}
  .icon{
    width:60px; height:60px; display:grid; place-items:center;
    background:var(--bg-gray); 
    margin-bottom:20px; font-size:30px; color:var(--rs-blue);
  }
  .benefit h3{margin:0 0 10px; font-size:18px; color:var(--rs-blue)}
  .benefit p{margin:0; color:var(--ink); line-height:1.6;}

  /* ===== Табы ===== */
  .tabs{
    display:flex; gap:0; margin:0 0 30px;
    border-bottom:2px solid var(--border);
  }
  .tab{
    padding:12px 24px; border:none; 
    background:transparent; color:var(--muted); 
    cursor:pointer; transition:all .2s;
    position:relative; font-size:16px;
  }
  .tab:hover{color:var(--rs-blue)}
  .tab.active{
    color:var(--rs-blue); 
  }
  .tab.active::after{
    content:''; position:absolute; bottom:-2px; left:0; right:0;
    height:2px; background:var(--rs-blue);
  }

  /* ===== Карточки комплектов ===== */
  .pack{text-align:center;}
  .pack-header{
    background:var(--rs-blue); color:#fff; 
    padding:20px; margin:-30px -30px 20px;
  }
  .pack-type{
    font-size:14px; text-transform:uppercase; 
    letter-spacing:1px; margin-bottom:10px;
  }
  .pack-title{font-size:22px; font-weight:700;}
  .price{
    font-size:36px; font-weight:700; color:var(--rs-blue);
    margin:20px 0;
  }
  .price small{font-size:16px; font-weight:400;}
  .features{text-align:left; margin:20px 0;}
  .features li{
    display:flex; align-items:center; gap:10px; 
    padding:10px 0; border-bottom:1px solid var(--bg-gray);
  }
  .features li:last-child{border-bottom:none;}
  .check{
    width:20px; height:20px; display:grid; place-items:center;
    background:var(--ok); color:#fff; font-size:12px;
  }
  
  /* ===== Калькулятор корпоративный ===== */
  .calc{display:grid; grid-template-columns:1fr 1fr; gap:40px;}
  .field{margin-bottom:20px;}
  .field label{
    display:block; margin-bottom:8px; 
    font-weight:500; color:var(--ink);
  }
  .input,select{
    width:100%; padding:10px 12px; 
    border:1px solid var(--border); 
    background:#fff; font:inherit; font-size:15px;
  }
  .input:focus,select:focus{
    outline:none; border-color:var(--rs-blue); 
  }
  
  /* Результаты */
  .results{background:var(--bg-gray); padding:30px; margin-top:20px;}
  .result-item{
    display:flex; justify-content:space-between; align-items:center; 
    padding:15px 0; border-bottom:1px solid var(--border);
  }
  .result-item:last-child{border-bottom:none;}
  .result-label{color:var(--muted);}
  .result-value{font-size:18px; font-weight:700; color:var(--rs-blue);}
  .result-item.total{
    font-size:20px; margin-top:10px; padding-top:20px;
    border-top:2px solid var(--rs-blue);
  }

  /* ===== Процесс ===== */
  .process{background:var(--bg-gray); padding:60px 0; margin:60px 0;}
  .process-grid{
    display:grid; grid-template-columns:repeat(5,1fr); gap:30px;
    max-width:var(--maxw); margin:0 auto; padding:0 15px;
  }
  .process-item{text-align:center;}
  .process-number{
    width:50px; height:50px; margin:0 auto 20px;
    background:var(--rs-blue); color:#fff;
    display:grid; place-items:center;
    font-size:20px; font-weight:700;
  }
  .process-title{font-weight:700; margin-bottom:10px;}
  .process-desc{font-size:14px; color:var(--muted);}

  /* ===== FAQ ===== */
  .faq-item{
    background:#fff; border:1px solid var(--border);
    margin-bottom:10px;
  }
  .faq-question{
    padding:20px; cursor:pointer; 
    font-weight:500; display:flex; 
    justify-content:space-between; align-items:center;
    transition:.2s;
  }
  .faq-question:hover{background:var(--bg-gray);}
  .faq-icon{
    font-size:20px; color:var(--rs-blue);
    transition:.2s transform;
  }
  .faq-item.open .faq-icon{transform:rotate(45deg);}
  .faq-answer{
    padding:0 20px 20px; display:none;
    color:var(--muted); line-height:1.6;
  }
  .faq-item.open .faq-answer{display:block;}

  /* ===== Форма ===== */
  .form-section{background:var(--bg-gray); padding:60px 0;}
  .form-container{
    max-width:600px; margin:0 auto; 
    background:#fff; padding:40px; border:1px solid var(--border);
  }
  form{display:grid; gap:20px;}
  .form-group{display:grid; gap:8px;}
  .form-group label{font-weight:500;}
  .required{color:var(--bad);}
  textarea.input{min-height:100px; resize:vertical;}
  .checkbox-group{
    display:flex; gap:10px; align-items:flex-start;
    font-size:14px; color:var(--muted);
  }
  .checkbox{width:20px; height:20px; flex:0 0 20px;}

  /* ===== Футер ===== */
  footer{
    background:var(--rs-blue); color:#fff; 
    padding:30px 0; margin-top:80px;
  }
  .foot{
    max-width:var(--maxw); margin:0 auto; padding:0 15px;
    display:flex; justify-content:space-between; align-items:center;
  }
  .foot .logo{color:#fff;}
  .foot small{opacity:.8;}

  /* ===== Мобильная адаптация ===== */
  @media (max-width:980px){
    .hero-stats{grid-template-columns:1fr}
    .grid.cols-3{grid-template-columns:1fr 1fr}
    .calc{grid-template-columns:1fr}
    .process-grid{grid-template-columns:1fr; gap:40px}
    .process-item{
      display:grid; grid-template-columns:50px 1fr; gap:20px;
      text-align:left;
    }
  }
  
  @media (max-width:640px){
    /* Мобильное меню */
    .menu-toggle{display:block}
    .navlinks{
      position:fixed; top:0; left:-100%; width:100%; height:100vh;
      background:#fff; flex-direction:column; 
      justify-content:flex-start; gap:0;
      padding:70px 0 0; transition:.3s left;
      z-index:999;
    }
    .navlinks.active{left:0}
    .navlinks a{
      padding:15px 30px; border-bottom:1px solid var(--border);
      width:100%;
    }
    .desktop-actions{display:none}
    
    /* Контент */
    section{padding:40px 15px}
    h1{font-size:28px}
    h2{font-size:24px}
    .lead{font-size:16px}
    .hero-stats{gap:15px}
    .grid.cols-3,.grid.cols-2{grid-template-columns:1fr}
    .tabs{flex-wrap:wrap}
    .tab{font-size:14px; padding:10px 16px}
    .process-number{width:40px; height:40px; font-size:16px}
  }

  /* ===== Печать ===== */
  @media print{
    header,.menu-toggle,.navlinks,.controls-only{display:none !important}
    body{background:#fff}
    section{padding:20px 0}
    .card{box-shadow:none; border:1px solid #ccc}
    h1,h2,.price{-webkit-text-fill-color:var(--rs-blue) !important}
    .btn{display:none}
  }
</style>
</head>
<body>

<div class="scrollbar" id="scrollbar"></div>

<!-- ===== Header ===== -->
<header>
  <nav class="nav">
    <div class="logo">
      <svg class="logo-img" viewBox="0 0 100 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="100" height="40" fill="#004B87"/>
        <text x="50" y="25" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">РОССЕТИ</text>
      </svg>
      <div class="logo-text">
        <div class="company">АО «Россети Кубань»</div>
        <div class="dept">Солнечная микрогенерация</div>
      </div>
    </div>
    
    <button class="menu-toggle" id="menuToggle" aria-label="Меню">
      <span></span><span></span><span></span>
    </button>
    
    <div class="navlinks" id="navLinks">
      <a href="#packs">Комплекты</a>
      <a href="#calc">Калькулятор</a>
      <a href="#process">Процесс работы</a>
      <a href="#faq">Вопросы</a>
    </div>
    
    <div class="desktop-actions">
      <a class="btn btn-primary" href="#lead">Оставить заявку</a>
    </div>
  </nav>
</header>

<!-- ===== Hero ===== -->
<div class="hero">
  <div class="wrap">
    <nav class="breadcrumb">
      <a href="#">Главная</a> / <a href="#">Услуги</a> / Солнечная микрогенерация
    </nav>
    
    <h1>Установка солнечных электростанций</h1>
    <p class="lead">
      Комплексное решение для частных домохозяйств и предприятий. 
      Проектирование, поставка оборудования, монтаж и подключение к сети 
      от официальной сетевой компании региона.
    </p>
    
    <div class="hero-stats">
      <div class="stat-card">
        <div class="number">от 226 090 ₽</div>
        <div class="label">Сетевые станции</div>
      </div>
      <div class="stat-card">
        <div class="number">от 430 290 ₽</div>
        <div class="label">Гибридные станции</div>
      </div>
      <div class="stat-card">
        <div class="number">от 308 690 ₽</div>
        <div class="label">Системы БП</div>
      </div>
    </div>
    
    <div style="margin-top:30px">
      <a class="btn btn-primary" href="#calc">Рассчитать стоимость</a>
      <a class="btn btn-secondary" href="#packs" style="margin-left:15px">Смотреть комплекты</a>
    </div>
  </div>
</div>

<!-- ===== Преимущества ===== -->
<section>
  <h2>Преимущества работы с сетевой компанией</h2>
  <p class="section-desc">
    Гарантированное подключение к сети и профессиональная реализация проекта
  </p>
  
  <div class="grid cols-3">
    <div class="card benefit">
      <div class="icon">⚡</div>
      <h3>Единое окно</h3>
      <p>Один договор на весь комплекс работ: от проектирования до ввода в эксплуатацию</p>
    </div>
    <div class="card benefit">
      <div class="icon">✓</div>
      <h3>Гарантия подключения</h3>
      <p>Как владельцы сетей, гарантируем техприсоединение и правильный учёт электроэнергии</p>
    </div>
    <div class="card benefit">
      <div class="icon">🛡</div>
      <h3>Официальная гарантия</h3>
      <p>5 лет на оборудование, 2 года на монтажные работы. Сервисное обслуживание</p>
    </div>
    <div class="card benefit">
      <div class="icon">📊</div>
      <h3>Прозрачный учёт</h3>
      <p>Двунаправленные счётчики, личный кабинет, автоматическая передача данных</p>
    </div>
    <div class="card benefit">
      <div class="icon">⏱</div>
      <h3>Быстрая реализация</h3>
      <p>От заявки до запуска — 45 дней. Четкие сроки на каждом этапе работ</p>
    </div>
    <div class="card benefit">
      <div class="icon">♻</div>
      <h3>Зелёная энергия</h3>
      <p>Снижение углеродного следа, продажа излишков электроэнергии в сеть</p>
    </div>
  </div>
</section>

<!-- ===== Комплекты ===== -->
<section id="packs">
  <h2>Готовые решения</h2>
  <p class="section-desc">Проверенное оборудование от российского производителя Хевел</p>

  <div class="tabs">
    <button class="tab active" data-tab="setev">Сетевые СЭС</button>
    <button class="tab" data-tab="gibrid">Гибридные СЭС</button>
    <button class="tab" data-tab="sbp">Системы БП</button>
  </div>

  <div class="grid cols-3" id="cards">
    <!-- Карточки генерируются JS -->
  </div>
</section>

<!-- ===== Калькулятор ===== -->
<section id="calc">
  <div class="card">
    <h2>Калькулятор стоимости</h2>
    <p class="section-desc">Рассчитайте стоимость проекта и срок окупаемости</p>

    <div class="calc">
      <div class="controls-only">
        <div class="field">
          <label for="cat">Тип системы</label>
          <select id="cat" class="input">
            <option value="setev">Сетевая СЭС</option>
            <option value="gibrid">Гибридная СЭС</option>
            <option value="sbp">Система БП</option>
          </select>
        </div>
        
        <div class="field">
          <label for="option">Комплектация</label>
          <select id="option" class="input"></select>
        </div>
        
        <div class="field">
          <label>
            <input type="checkbox" id="add_proj" class="checkbox" checked>
            Включить проектирование и техприсоединение
          </label>
          <input id="proj_cost" class="input" type="number" step="1000" value="45000" style="margin-top:10px">
        </div>
        
        <div class="field">
          <label for="mont_perc">Стоимость монтажа, % от оборудования</label>
          <input id="mont_perc" class="input" type="number" min="10" max="25" step="1" value="15">
        </div>
        
        <div class="field">
          <label for="dist">Расстояние до точки подключения, м</label>
          <input id="dist" class="input" type="number" min="0" max="100" step="5" value="15">
        </div>
        
        <div class="field">
          <label for="tariff">Текущий тариф на электроэнергию, ₽/кВт·ч</label>
          <input id="tariff" class="input" type="number" step="0.1" value="6.0">
        </div>
        
        <div class="field">
          <label for="specgen">Среднегодовая инсоляция</label>
          <select id="specgen" class="input">
            <option value="1100">Северные регионы (1100 кВт·ч/кВт·год)</option>
            <option value="1300" selected>Краснодарский край (1300 кВт·ч/кВт·год)</option>
            <option value="1400">Южные регионы (1400 кВт·ч/кВт·год)</option>
          </select>
        </div>
      </div>

      <div>
        <div class="results">
          <div class="result-item">
            <span class="result-label">Стоимость оборудования</span>
            <span class="result-value" id="equip">— ₽</span>
          </div>
          <div class="result-item">
            <span class="result-label">Проектирование и ТП</span>
            <span class="result-value" id="proj">— ₽</span>
          </div>
          <div class="result-item">
            <span class="result-label">Монтажные работы</span>
            <span class="result-value" id="mont">— ₽</span>
          </div>
          <div class="result-item total">
            <span class="result-label"><strong>Итого под ключ</strong></span>
            <span class="result-value" id="sum">— ₽</span>
          </div>
          <div class="result-item">
            <span class="result-label">Годовая выработка</span>
            <span class="result-value" id="gen">— кВт·ч</span>
          </div>
          <div class="result-item">
            <span class="result-label">Экономия в год</span>
            <span class="result-value" id="save">— ₽</span>
          </div>
          <div class="result-item">
            <span class="result-label">Срок окупаемости</span>
            <span class="result-value" id="pp">— лет</span>
          </div>
        </div>
        
        <div style="margin-top:20px">
          <a class="btn btn-primary" href="#lead">Получить точный расчёт</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ===== Процесс ===== -->
<div class="process" id="process">
  <div style="max-width:var(--maxw); margin:0 auto; padding:0 15px;">
    <h2>Процесс реализации проекта</h2>
    <p class="section-desc">От заявки до запуска — 45 дней</p>
    
    <div class="process-grid">
      <div class="process-item">
        <div class="process-number">1</div>
        <div class="process-title">Заявка</div>
        <div class="process-desc">Консультация и предварительный расчёт</div>
      </div>
      <div class="process-item">
        <div class="process-number">2</div>
        <div class="process-title">Проект</div>
        <div class="process-desc">Выезд на объект, проектирование, ТУ</div>
      </div>
      <div class="process-item">
        <div class="process-number">3</div>
        <div class="process-title">Поставка</div>
        <div class="process-desc">Комплектация и доставка оборудования</div>
      </div>
      <div class="process-item">
        <div class="process-number">4</div>
        <div class="process-title">Монтаж</div>
        <div class="process-desc">Установка и подключение системы</div>
      </div>
      <div class="process-item">
        <div class="process-number">5</div>
        <div class="process-title">Запуск</div>
        <div class="process-desc">Ввод в эксплуатацию, настройка учёта</div>
      </div>
    </div>
  </div>
</div>

<!-- ===== FAQ ===== -->
<section id="faq">
  <h2>Часто задаваемые вопросы</h2>
  
  <div class="faq-list">
    <div class="faq-item open">
      <div class="faq-question">
        Нужно ли разрешение на установку солнечных панелей?
        <span class="faq-icon">+</span>
      </div>
      <div class="faq-answer">
        Для объектов микрогенерации мощностью до 15 кВт специального разрешения не требуется. 
        Необходимо только техническое присоединение к электросетям, которое мы полностью берём на себя.
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question">
        Можно ли продавать излишки электроэнергии?
        <span class="faq-icon">+</span>
      </div>
      <div class="faq-answer">
        Да, согласно закону о микрогенерации, излишки электроэнергии выкупаются 
        гарантирующим поставщиком по установленным тарифам. Мы настроим систему 
        учёта для автоматической продажи излишков.
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question">
        Какая гарантия предоставляется?
        <span class="faq-icon">+</span>
      </div>
      <div class="faq-answer">
        На солнечные модули — 5 лет официальной гарантии и 25 лет на сохранение 
        80% мощности. На инверторы — 5 лет. На монтажные работы — 2 года.
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question">
        Работают ли панели зимой?
        <span class="faq-icon">+</span>
      </div>
      <div class="faq-answer">
        Да, солнечные панели работают круглый год. Зимой выработка снижается 
        из-за короткого светового дня, но холод улучшает КПД панелей. 
        Снег необходимо периодически очищать.
      </div>
    </div>
  </div>
</section>

<!-- ===== Форма ===== -->
<div class="form-section" id="lead">
  <div class="form-container">
    <h2 style="text-align:left; margin-bottom:10px;">Оставить заявку</h2>
    <p style="margin-bottom:30px;">Получите индивидуальный расчёт для вашего объекта</p>
    
    <form id="leadForm">
      <div class="form-group">
        <label>Имя <span class="required">*</span></label>
        <input class="input" name="name" required>
      </div>
      
      <div class="form-group">
        <label>Телефон <span class="required">*</span></label>
        <input class="input" name="phone" type="tel" required>
      </div>
      
      <div class="form-group">
        <label>Email</label>
        <input class="input" name="email" type="email">
      </div>
      
      <div class="form-group">
        <label>Интересующий комплект</label>
        <select class="input" name="pack">
          <option>Не определился</option>
          <option>Сетевая СЭС</option>
          <option>Гибридная СЭС</option>
          <option>Система БП</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Адрес объекта</label>
        <input class="input" name="address">
      </div>
      
      <div class="form-group">
        <label>Комментарий</label>
        <textarea class="input" name="comment"></textarea>
      </div>
      
      <div class="checkbox-group">
        <input type="checkbox" class="checkbox" required>
        <span>Согласен на обработку персональных данных</span>
      </div>
      
      <button class="btn btn-primary" type="submit" style="width:200px;">
        Отправить заявку
      </button>
      
      <div id="formMsg" style="margin-top:15px; font-size:14px;"></div>
    </form>
  </div>
</div>

<!-- ===== Footer ===== -->
<footer>
  <div class="foot">
    <div class="logo">
      <div class="logo-text">
        <div class="company" style="color:#fff">АО «Россети Кубань»</div>
        <div class="dept" style="color:rgba(255,255,255,0.8)">Солнечная микрогенерация</div>
      </div>
    </div>
    <small>© 2025 АО «Россети Кубань». Все права защищены.</small>
  </div>
</footer>

<!-- Мобильная панель -->
<nav class="mbar" aria-label="Мобильная навигация">
  <a href="#packs">
    <span class="icon">📦</span>
    <span>Пакеты</span>
  </a>
  <a href="#calc" class="active">
    <span class="icon">💰</span>
    <span>Расчёт</span>
  </a>
  <a href="#lead">
    <span class="icon">📞</span>
    <span>Заявка</span>
  </a>
  <a href="#faq">
    <span class="icon">❓</span>
    <span>FAQ</span>
  </a>
</nav>

<a class="cta floating-cta" href="#lead">💬 Консультация</a>

<script>
  // ====== Конфигурация ======
  const EMAIL_ADDRESSES = ["abusalimov@gmail.ru"];
  
  // EmailJS конфигурация (получите эти данные на https://www.emailjs.com/)
  const EMAILJS_SERVICE_ID = "YOUR_SERVICE_ID"; // Замените на ваш Service ID
  const EMAILJS_TEMPLATE_ID = "YOUR_TEMPLATE_ID"; // Замените на ваш Template ID
  
  // Google Apps Script endpoint
  const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby2D1kkxg6Vdv-1gESfwN9hqhBekC2uzSZp7bqrfIgCU7wZoQULiwjUuLWSqvfNX0w/exec";

  // ====== Прайс-листы (из PDF) ======
  const PRICES = {
    setev: [
      {kw:5,  phase:'1 фаза', price:226090, popular:true},
      {kw:5,  phase:'3 фазы', price:239890},
      {kw:10, phase:'3 фазы', price:391890, popular:true},
      {kw:15, phase:'3 фазы', price:632590, popular:true},
      {kw:25, phase:'3 фазы', price:887990},
      {kw:50, phase:'3 фазы', price:1133790},
      {kw:100,phase:'3 фазы', price:3293690}
    ],
    gibrid: [
      {kw:5,  phase:'1 фаза', akb:5,  price:430290},
      {kw:5,  phase:'1 фаза', akb:10, price:586990, popular:true},
      {kw:8,  phase:'1 фаза', akb:10, price:775590},
      {kw:8,  phase:'1 фаза', akb:15, price:932390, popular:true},
      {kw:12, phase:'3 фазы', akb:10, price:942090},
      {kw:12, phase:'3 фазы', akb:15, price:1082090, popular:true},
      {kw:12, phase:'3 фазы', akb:20, price:1238790},
      {kw:15, phase:'3 фазы', akb:15, price:1296890},
      {kw:15, phase:'3 фазы', akb:20, price:1453590}
    ],
    sbp: [
      {kw:5,  phase:'1 фаза', akb:5,  price:308690, popular:true},
      {kw:5,  phase:'1 фаза', akb:10, price:465390},
      {kw:8,  phase:'1 фаза', akb:10, price:578990, popular:true},
      {kw:8,  phase:'1 фаза', akb:15, price:735690},
      {kw:12, phase:'3 фазы', akb:10, price:630490},
      {kw:12, phase:'3 фазы', akb:15, price:787090, popular:true},
      {kw:12, phase:'3 фазы', akb:20, price:943890},
      {kw:15, phase:'3 фазы', akb:15, price:932590},
      {kw:15, phase:'3 фазы', akb:20, price:1089290}
    ]
  };

  // ====== Хелперы ======
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const money = n => n.toLocaleString('ru-RU');
  const clamp = (x,min,max) => Math.min(max,Math.max(min,x));

  // ====== Прогресс-бар ======
  const scrollbar = $('#scrollbar');
  function updateScrollProgress() {
    const h = document.documentElement;
    const progress = (h.scrollTop) / (h.scrollHeight - h.clientHeight) * 100;
    scrollbar.style.width = progress + '%';
  }
  window.addEventListener('scroll', updateScrollProgress, {passive:true});
  updateScrollProgress();

  // ====== Плавная прокрутка ======
  $$('a[href^="#"]').forEach(link => {
    link.addEventListener('click', e => {
      const href = link.getAttribute('href');
      if (href && href.length > 1) {
        e.preventDefault();
        const target = document.querySelector(href);
        if (target) {
          const offset = 80; // Отступ от хедера
          const top = target.offsetTop - offset;
          window.scrollTo({top, behavior:'smooth'});
          
          // Закрыть мобильное меню
          $('#navLinks').classList.remove('active');
          $('#menuToggle').classList.remove('active');
        }
      }
    });
  });

  // ====== Мобильное меню ======
  const menuToggle = $('#menuToggle');
  const navLinks = $('#navLinks');
  menuToggle?.addEventListener('click', () => {
    menuToggle.classList.toggle('active');
    navLinks.classList.toggle('active');
  });

  // ====== Intersection Observer для анимаций ======
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('_in');
        observer.unobserve(entry.target);
      }
    });
  }, {threshold: 0.1});

  $$('.card, .stat, .timeline-item').forEach(el => observer.observe(el));

  // ====== Табы и карточки комплектов ======
  const cards = $('#cards');
  const tabs = $('.tab');
  let activeTab = 'setev';

  function renderCards() {
    const data = PRICES[activeTab];
    const popular = data.filter(r => r.popular).slice(0, 3);
    const items = popular.length >= 3 ? popular : data.slice(0, 3);
    
    cards.innerHTML = items.map((r, i) => {
      const type = activeTab === 'setev' ? 'Сетевая СЭС' : 
                   activeTab === 'gibrid' ? 'Гибридная СЭС' : 'Система БП';
      
      return `
        <div class="card pack">
          <div class="pack-header">
            <div class="pack-type">${type}</div>
            <div class="pack-title">${r.kw} кВт ${r.phase}${r.akb ? ` / ${r.akb} кВт·ч` : ''}</div>
          </div>
          <div class="price">${money(r.price)} <small>руб.</small></div>
          <div class="features">
            <li><div class="check">✓</div><div>${activeTab !== 'sbp' ? 'Солнечные модули Хевел' : 'Инверторное оборудование'}</div></li>
            <li><div class="check">✓</div><div>${activeTab === 'setev' ? 'Сетевой инвертор' : activeTab === 'gibrid' ? 'Гибридный инвертор' : 'ИБП с функцией заряда'}</div></li>
            <li><div class="check">✓</div><div>Кабели и автоматика</div></li>
            ${r.akb ? '<li><div class="check">✓</div><div>Литиевые аккумуляторы</div></li>' : ''}
          </div>
          
          <a class="btn btn-primary" href="#calc" data-cat="${activeTab}" data-idx="${i}" style="width:100%">
            Рассчитать проект
          </a>
          
          <p style="font-size:12px; color:var(--muted); margin-top:15px; text-align:center">
            * Без учета монтажа и опорных конструкций
          </p>
        </div>
      `;
    }).join('');
    
    // Обработчики для кнопок
    $('a[data-cat]').forEach(btn => {
      btn.addEventListener('click', () => {
        const cat = btn.getAttribute('data-cat');
        const idx = btn.getAttribute('data-idx');
        $('#cat').value = cat;
        populateOptions();
        if (idx !== null) $('#option').value = idx;
        estimate();
      });
    });
  }

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      activeTab = tab.getAttribute('data-tab');
      renderCards();
    });
  });
  
  renderCards();

  // ====== Калькулятор ======
  const controls = {
    cat: $('#cat'),
    option: $('#option'),
    addProj: $('#add_proj'),
    projCost: $('#proj_cost'),
    montPerc: $('#mont_perc'),
    dist: $('#dist'),
    tariff: $('#tariff'),
    specgen: $('#specgen')
  };
  
  const outputs = {
    equip: $('#equip'),
    proj: $('#proj'),
    mont: $('#mont'),
    sum: $('#sum'),
    gen: $('#gen'),
    save: $('#save'),
    pp: $('#pp')
  };

  // Обновление значений слайдеров
  $('#mont_perc')?.addEventListener('input', e => {
    $('#mont_val').textContent = e.target.value + '%';
  });
  $('#dist')?.addEventListener('input', e => {
    $('#dist_val').textContent = e.target.value + ' м';
  });

  function populateOptions() {
    const cat = controls.cat.value;
    const arr = PRICES[cat] || [];
    controls.option.innerHTML = arr.map((r, i) => {
      const label = cat === 'setev' 
        ? `${r.kw} кВт • ${r.phase} — ${money(r.price)} ₽`
        : `${r.kw} кВт • ${r.phase} • АКБ ${r.akb} кВт·ч — ${money(r.price)} ₽`;
      return `<option value="${i}">${label}</option>`;
    }).join('');
    
    // Рекомендуемый процент монтажа
    controls.montPerc.value = cat === 'setev' ? 15 : 18;
    $('#mont_val').textContent = controls.montPerc.value + '%';
    estimate();
  }

  function estimate() {
    const cat = controls.cat.value;
    const arr = PRICES[cat] || [];
    const idx = parseInt(controls.option.value) || 0;
    const item = arr[idx];
    
    if (!item) return;
    
    const equip = item.price;
    const proj = controls.addProj.checked ? Math.max(0, +controls.projCost.value || 0) : 0;
    const montPerc = Math.max(0, +controls.montPerc.value || 0) / 100;
    const dist = Math.max(0, +controls.dist.value || 0);
    
    // Монтаж: процент от оборудования + кабельная трасса
    const cablePrice = 250; // ₽/м примерная стоимость
    const mont = Math.round(equip * montPerc + dist * cablePrice);
    const total = equip + proj + mont;
    
    outputs.equip.textContent = money(equip) + ' ₽';
    outputs.proj.textContent = money(proj) + ' ₽';
    outputs.mont.textContent = money(mont) + ' ₽';
    outputs.sum.textContent = money(total) + ' ₽';
    
    // Выработка и окупаемость
    const kw = item.kw;
    const specGen = +controls.specgen.value || 1300;
    const yearGen = kw * specGen;
    const tariff = Math.max(1, +controls.tariff.value || 6.0);
    const yearSave = yearGen * tariff;
    const payback = yearSave > 0 ? total / yearSave : 0;
    
    outputs.gen.textContent = money(Math.round(yearGen)) + ' кВт·ч';
    outputs.save.textContent = money(Math.round(yearSave)) + ' ₽/год';
    outputs.pp.textContent = payback > 0 ? payback.toFixed(1) + ' лет' : '—';
    
    // Сохранение в localStorage
    const config = {
      cat,
      idx,
      addProj: controls.addProj.checked,
      projCost: +controls.projCost.value,
      montPerc: +controls.montPerc.value,
      dist: +controls.dist.value,
      tariff: +controls.tariff.value,
      specgen: +controls.specgen.value
    };
    localStorage.setItem('solar_calc', JSON.stringify(config));
  }

  // События калькулятора
  Object.values(controls).forEach(control => {
    control.addEventListener('input', estimate);
    control.addEventListener('change', estimate);
  });

  // Восстановление сохраненных значений
  try {
    const saved = JSON.parse(localStorage.getItem('solar_calc') || 'null');
    if (saved) {
      controls.cat.value = saved.cat || 'setev';
      populateOptions();
      controls.option.value = saved.idx || 0;
      controls.addProj.checked = saved.addProj ?? true;
      controls.projCost.value = saved.projCost ?? 45000;
      controls.montPerc.value = saved.montPerc ?? 15;
      controls.dist.value = saved.dist ?? 15;
      controls.tariff.value = saved.tariff ?? 6.0;
      controls.specgen.value = saved.specgen ?? 1300;
      
      $('#mont_val').textContent = controls.montPerc.value + '%';
      $('#dist_val').textContent = controls.dist.value + ' м';
    }
  } catch {
    populateOptions();
  }
  
  populateOptions();

  // ====== Печать ======
  $('#btnPrint')?.addEventListener('click', () => window.print());

  // ====== Форма ======
  const form = $('#leadForm');
  const formMsg = $('#formMsg');
  const submitBtn = form.querySelector('button[type="submit"]');
  const spinner = submitBtn.querySelector('.spinner');
  
  // Вариант 1: Отправка через EmailJS
  async function sendViaEmailJS(fields) {
    if (!EMAILJS_SERVICE_ID || EMAILJS_SERVICE_ID === "YOUR_SERVICE_ID") {
      throw new Error('EmailJS не настроен');
    }
    
    const templateParams = {
      to_email: EMAIL_ADDRESSES.join(','), // Отправка на оба адреса
      from_name: fields.name,
      from_email: fields.email || 'не указан',
      phone: fields.phone,
      address: fields.address || 'не указан',
      pack_type: fields.pack || 'не выбран',
      comment: fields.comment || 'без комментария',
      date: new Date().toLocaleString('ru-RU')
    };
    
    return emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams);
  }
  
  // Вариант 2: Отправка через Google Apps Script
  async function sendViaGoogleScript(fields) {
    if (!GOOGLE_SCRIPT_URL) {
      throw new Error('Google Script не настроен');
    }
    
    const data = {
      emails: EMAIL_ADDRESSES,
      subject: 'Заявка: Солнечная микрогенерация',
      name: fields.name,
      phone: fields.phone,
      email: fields.email || '',
      address: fields.address || '',
      pack: fields.pack || '',
      comment: fields.comment || '',
      date: new Date().toLocaleString('ru-RU')
    };
    
    const res = await fetch(GOOGLE_SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data)
    });
    
    // no-cors не возвращает ответ, считаем успешным
    return {ok: true};
  }
  
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // UI feedback
    spinner.style.display = 'inline-block';
    submitBtn.disabled = true;
    formMsg.textContent = '';
    
    const data = new FormData(form);
    const fields = Object.fromEntries(data.entries());
    
    const message = [
      '☀️ <b>Новая заявка: Солнечная микрогенерация</b>',
      '',
      `👤 <b>Имя:</b> ${fields.name || '—'}`,
      `📱 <b>Телефон:</b> ${fields.phone || '—'}`,
      `📧 <b>Email:</b> ${fields.email || '—'}`,
      `📍 <b>Адрес:</b> ${fields.address || '—'}`,
      `🏷️ <b>Комплект:</b> ${fields.pack || '—'}`,
      `💬 <b>Комментарий:</b> ${fields.comment || '—'}`,
      '',
      `⏰ <b>Время:</b> ${new Date().toLocaleString('ru-RU')}`
    ].join('\n');
    
    try {
      // Попробуем отправить через EmailJS
      if (EMAILJS_SERVICE_ID && EMAILJS_SERVICE_ID !== "YOUR_SERVICE_ID") {
        await sendViaEmailJS(fields);
        formMsg.textContent = '✅ Заявка отправлена на email! Мы свяжемся с вами в ближайшее время.';
        formMsg.style.color = 'var(--ok)';
        form.reset();
        submitBtn.innerHTML = '✅ Отправлено!';
      } 
      // Или через Google Apps Script
      else if (GOOGLE_SCRIPT_URL) {
        await sendViaGoogleScript(fields);
        formMsg.textContent = '✅ Заявка отправлена! Мы свяжемся с вами в ближайшее время.';
        formMsg.style.color = 'var(--ok)';
        form.reset();
        submitBtn.innerHTML = '✅ Отправлено!';
      } 
      // Fallback на mailto
      else {
        const subject = 'Заявка: Солнечная микрогенерация';
        const body = message.replace(/<[^>]+>/g, '').replace(/\n/g, '%0D%0A');
        const emailList = EMAIL_ADDRESSES.join(',');
        const mailto = `mailto:${emailList}?subject=${encodeURIComponent(subject)}&body=${body}`;
        
        window.location.href = mailto;
        formMsg.textContent = '📧 Открываю почтовый клиент для отправки...';
        formMsg.style.color = 'var(--warn)';
      }
      
      setTimeout(() => {
        submitBtn.innerHTML = '📨 Отправить заявку';
      }, 3000);
      
    } catch (err) {
      console.error('Ошибка отправки:', err);
      // Fallback на mailto при любой ошибке
      const subject = 'Заявка: Солнечная микрогенерация';
      const body = message.replace(/<[^>]+>/g, '').replace(/\n/g, '%0D%0A');
      const emailList = EMAIL_ADDRESSES.join(',');
      const mailto = `mailto:${emailList}?subject=${encodeURIComponent(subject)}&body=${body}`;
      
      window.location.href = mailto;
      formMsg.textContent = '📧 Открываю почтовый клиент для отправки...';
      formMsg.style.color = 'var(--warn)';
    } finally {
      spinner.style.display = 'none';
      submitBtn.disabled = false;
    }
  });

  // ====== Активная ссылка в мобильном меню ======
  const mbarLinks = $('.mbar a');
  function updateActiveSection() {
    const sections = ['#packs', '#calc', '#lead', '#faq'];
    const scrollPos = window.scrollY + 100;
    
    sections.forEach((id, idx) => {
      const section = $(id);
      if (section) {
        const top = section.offsetTop;
        const height = section.offsetHeight;
        
        if (scrollPos >= top && scrollPos < top + height) {
          mbarLinks.forEach(link => link.classList.remove('active'));
          if (mbarLinks[idx]) mbarLinks[idx].classList.add('active');
        }
      }
    });
  }
  
  window.addEventListener('scroll', updateActiveSection, {passive: true});
  updateActiveSection();

  // ====== Анимация чипов при наведении на иллюстрацию ======
  const illus = $('.illus');
  const chips = illus?.querySelectorAll('.chip');
  
  illus?.addEventListener('mouseenter', () => {
    chips?.forEach((chip, i) => {
      setTimeout(() => {
        chip.style.transform = 'scale(1.1)';
      }, i * 100);
    });
  });
  
  illus?.addEventListener('mouseleave', () => {
    chips?.forEach(chip => {
      chip.style.transform = '';
    });
  });

  // ====== Счетчики анимация ======
  function animateValue(el, start, end, duration) {
    const range = end - start;
    const startTime = Date.now();
    
    const timer = setInterval(() => {
      const elapsed = Date.now() - startTime;
      const progress = Math.min(elapsed / duration, 1);
      const value = Math.floor(start + range * progress);
      
      el.textContent = money(value) + ' ₽';
      
      if (progress >= 1) clearInterval(timer);
    }, 16);
  }

  // Анимация при появлении hero-cards
  const heroObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const priceEls = entry.target.querySelectorAll('strong');
        priceEls.forEach(el => {
          const text = el.textContent.replace(/[^\d]/g, '');
          const value = parseInt(text) || 0;
          if (value > 0) {
            animateValue(el, 0, value, 1000);
          }
        });
        heroObserver.unobserve(entry.target);
      }
    });
  }, {threshold: 0.5});

  $('.hero-cards .stat').forEach(el => heroObserver.observe(el));

  // ====== Параллакс эффект для hero ======
  let ticking = false;
  function updateParallax() {
    if (!ticking) {
      requestAnimationFrame(() => {
        const scrolled = window.pageYOffset;
        const speed = 0.5;
        
        // Двигаем фоновые элементы
        const floatEls = $('.float-el');
        floatEls.forEach((el, i) => {
          const yPos = -(scrolled * speed * (i + 1) * 0.3);
          el.style.transform = `translateY(${yPos}px)`;
        });
        
        ticking = false;
      });
      ticking = true;
    }
  }
  
  window.addEventListener('scroll', updateParallax, {passive: true});

  // ====== Предзагрузка изображений ======
  const imagesToPreload = [
    '/images/solar-panel-1.jpg',
    '/images/solar-panel-2.jpg',
    '/images/installation-1.jpg',
    '/images/installation-2.jpg'
  ];
  
  imagesToPreload.forEach(src => {
    const img = new Image();
    img.src = src;
  });

  // ====== PWA: Регистрация Service Worker (опционально) ======
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js').catch(() => {
        // Игнорируем ошибки, SW опционален
      });
    });
  }

  // ====== Метрика для отслеживания конверсий ======
  function trackEvent(action, category = 'engagement', label = '') {
    // Здесь можно добавить Google Analytics, Яндекс.Метрику и т.д.
    console.log('Event:', {action, category, label});
    
    // Пример для GA4
    if (typeof gtag !== 'undefined') {
      gtag('event', action, {
        event_category: category,
        event_label: label
      });
    }
  }

  // Отслеживание важных действий
  $('.cta').forEach(btn => {
    btn.addEventListener('click', () => {
      trackEvent('cta_click', 'conversion', btn.textContent);
    });
  });

  form?.addEventListener('submit', () => {
    trackEvent('form_submit', 'conversion', 'lead_form');
  });

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      trackEvent('tab_switch', 'engagement', tab.textContent);
    });
  });

  // ====== Оптимизация производительности ======
  // Debounce для ресурсоемких операций
  function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }

  // Throttle для событий прокрутки
  function throttle(func, limit) {
    let inThrottle;
    return function(...args) {
      if (!inThrottle) {
        func.apply(this, args);
        inThrottle = true;
        setTimeout(() => inThrottle = false, limit);
      }
    };
  }

  // Оптимизированные обработчики
  const optimizedScroll = throttle(updateActiveSection, 100);
  window.addEventListener('scroll', optimizedScroll, {passive: true});

  // ====== Доступность (A11Y) ======
  // Управление фокусом для мобильного меню
  menuToggle?.addEventListener('click', () => {
    if (navLinks.classList.contains('active')) {
      const firstLink = navLinks.querySelector('a');
      firstLink?.focus();
    }
  });

  // Escape закрывает мобильное меню
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && navLinks.classList.contains('active')) {
      navLinks.classList.remove('active');
      menuToggle.classList.remove('active');
      menuToggle.focus();
    }
  });

  // ====== Финальная инициализация ======
  console.log('🌟 Сайт Россети Кубань - Солнечная микрогенерация');
  console.log('💡 Версия: 2.0.0');
  console.log('📧 Email для заявок: abusalimov@gmail.ru');

/* 
====== КОД ДЛЯ GOOGLE APPS SCRIPT (ВАРИАНТ 2) ======

Если вы хотите использовать бесплатное решение через Google:

1. Откройте https://script.google.com/
2. Создайте новый проект
3. Вставьте следующий код:

function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    
    // Email адрес получателя
    const recipients = 'abusalimov@gmail.ru';
    
    // Формирование письма
    const subject = data.subject || 'Новая заявка с сайта';
    const htmlBody = `
      <h2>Новая заявка: Солнечная микрогенерация</h2>
      <table style="border-collapse: collapse; width: 100%;">
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Имя:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.name}</td></tr>
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Телефон:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.phone}</td></tr>
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Email:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.email || 'не указан'}</td></tr>
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Адрес объекта:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.address || 'не указан'}</td></tr>
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Тип комплекта:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.pack || 'не выбран'}</td></tr>
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Комментарий:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.comment || 'отсутствует'}</td></tr>
        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Дата заявки:</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${data.date}</td></tr>
      </table>
    `;
    
    // Отправка email
    GmailApp.sendEmail(recipients, subject, '', {
      htmlBody: htmlBody,
      name: 'Сайт Россети Кубань'
    });
    
    return ContentService.createTextOutput('OK');
  } catch (error) {
    console.error(error);
    return ContentService.createTextOutput('ERROR');
  }
}

4. Сохраните проект
5. Нажмите "Развернуть" > "Новое развертывание"
6. Выберите тип "Веб-приложение"
7. Установите "Кто имеет доступ" = "Все"
8. Скопируйте URL развертывания
9. Вставьте URL в переменную GOOGLE_SCRIPT_URL в начале этого файла

====== КОНЕЦ КОДА GOOGLE APPS SCRIPT ======
*/
</script>

</body>
</html>
